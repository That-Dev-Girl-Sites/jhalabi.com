<!DOCTYPE html>
<html lang="en">

<head>
  <title>
    Featured images, Gutenberg, and you | Joni Halabi</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=PT+Mono&display=swap" rel="stylesheet">

  <link rel="stylesheet" type="text/css" href="/css/styles.css">

  <meta name="description" content="Joni Halabi is a web developer, author of Sweet Little You, and conference speaker who writes technical articles, as well as creative works that focus on life as a single mother by choice.">
  <meta name="keywords" content="web developer, wordpress, author, writer, speaker, instructor, teacher, gutenberg, javascript, sweet little you, kid lit, single mother by choice, donor conceived">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">

  <meta property="og:title" content="Featured images, Gutenberg, and you">
  <meta property="og:url" content="//jhalabi.com//blog/2019/03/wordpress-featured-image-and-gutenberg/">
  <meta property="og:description" content="A very common editor update that us WordPress developers make is to add options to the featured image meta box in the post editor.">

  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/site.webmanifest">
  <link rel="mask-icon" href="/assets/icons/safari-pinned-tab.svg" color="#b26e63">
  <link rel="shortcut icon" href="/assets/icons/favicon.ico">
  <meta name="msapplication-TileColor" content="#222222">
  <meta name="msapplication-config" content="/assets/icons/browserconfig.xml">
  <meta name="theme-color" content="#222222">
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LMXWQM7X1W"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-LMXWQM7X1W');
  </script>
</head>



<body>
  <nav aria-label="Skip link">
    <a href="#main" class="skip-link">Skip to content</a>
  </nav>

  <header class="site-header">
    
      <p class="nameplate">
        <a href="/">Joni Halabi</a>
      </p>
    

    <p class="tagline">
      website creator, author, speaker, single mom, runner, music lover, chatty introvert
    </p>

    <nav class="nav-primary" aria-label="Main">
      <ul>
        <li ><a href="/" aria-label="Home">..</a></li>
        <li ><a href="/book/"     >Book</a></li>
        <li class="current"><a href="/blog/"     >Blog</a></li>
        <li ><a href="/speaking/" >Speaking</a></li>
        <li ><a href="/coding/"   >Coding</a></li>
        <li ><a href="/contact/"  >Contact</a></li>
      </ul>
    </nav>
  </header>

<main id="main">

  <div class="post-meta">
    <p class="categories">
      
        
      
        
          <a href="/blog/development/" class="category development">development</a>
        
      
        
          <a href="/blog/wordpress/" class="category wordpress">wordpress</a>
        
      
    </p>

    <h1 id="post-title">Featured images, Gutenberg, and you</h1>

    <p class="date">
      25 March 2019
    </p>
  </div>

  <article class="post-article" aria-labelledby="post-title">
    <p>A very common editor update that us WordPress developers make is to add options to the featured image meta box in the post editor. This is usually something like a checkbox to determine whether the featured image should be displayed at the top of a post.</p>
<h2>The good old (pre-5.0) days</h2>
<p>Before WordPress 5.0, this was usually accomplished in PHP, using the <a href="https://developer.wordpress.org/reference/hooks/admin_post_thumbnail_html/"><code>admin_post_thumbnail_html</code></a> hook. For a great example of this hook's usage, check out this article on how to <a href="https://www.billerickson.net/code/add-checkbox-to-featured-image-metabox/">add a checkbox to the featured image meta box</a>. However, now that the new core editor (a.k.a. <em>Gutenberg</em>) is in play, the featured image is now controlled by that new editor. In other words, our reliable old PHP hook no longer works. We now have to modify the featured image box in Javascipt.</p>
<h2>Wait a sec. Did you say JavaScript?!</h2>
<p>Yup! Specifically, we need to update the React component that writes out the featured image box. This code is a bit different than what you would write to create a new Gutenberg block. You are still going through the Gutenberg API, but this more closely resembles React than the block registration code.</p>
<p>This one function, which rewrites the markup inside of the featured image box in the post editor, does all of the heavy lifting:</p>
<pre><code class="language-javascript">function setFeaturedImageDisplay( OriginalComponent ) {
  return ( props ) =&gt; {

    // Get meta field information from the DB.
    let meta = select( 'core/editor' ).getCurrentPostAttribute( 'meta' );

    // Create featured image display option field.
    const displayOption = withState( {
       isChecked: meta.featured_image_display,
     } )( ( { isChecked, setState } ) =&gt; (
       &lt;CheckboxControl
        label = 'Display this image at the top of the page.'
        checked={ isChecked }
        onChange={ ( isChecked ) =&gt; {
          // Update the field in the editor.
          setState( { isChecked } );

          // Save the new value to the DB.
          meta.featured_image_display = isChecked;
          dispatch( 'core/editor' ).editPost( { meta } );
        } }
      /&gt;
    ) );

    // Return the entire featured image box.
    return (
      createElement( 'div', { }, [
        // Display the original featured image box.
        createElement( OriginalComponent, props ),

        // Add a checkbox below the featured image to control display option.
        createElement( displayOption )
      ] )
    );

  }
}
</code></pre>
<p>After that, all you need is to add a hook in your JavaScript to update the featured image block in the post editor:</p>
<pre><code class="language-javascript">wp.hooks.addFilter( 'editor.PostFeaturedImage', 'MY-NAMESPACE/featured-image-display', setFeaturedImageDisplay	);
</code></pre>
<h2>You still get to write (a little) PHP</h2>
<p>Good news everyone! You still need to write some PHP to register the meta field with WordPress. This uses the <code>register_meta</code> function. You can put this anywhere in a custom plugin or your theme, but I recommend adding this to the same plugin where your JavaScript lives, to keep your code all in one place.</p>
<pre><code class="language-php">function set_featured_image_display() {
  register_meta(
    'post',
    'MY_FIELD_NAME',
    array(
      'show_in_rest' =&gt; true,
      'single' =&gt; true,
      'type' =&gt; 'boolean'
    )
  );
}

add_action( 'init', 'set_featured_image_display' );
</code></pre>
<hr>
<p><strong>Check out these great references!</strong></p>
<ul>
<li><a href="https://github.com/danielbachhuber/gutenberg-migration-guide/blob/master/filter-admin-post-thumbnail-html.md">The Gutenberg Migration Guide on the post thumbnail HTML filter</a></li>
<li><a href="https://digitalapps.com/gutenberg-extending-featured-image-component/">Gutenberg Apps: Extending Featured Image Component</a></li>
<li><a href="https://developer.wordpress.org/reference/functions/register_meta/">WordPress code reference for register_meta</a></li>
</ul>

  </article>

  <div class="post-share">
    Share this article: 

    <a class="ri-bluesky-fill" target="_blank" href="https://bsky.app/intent/compose?text=Check out “Featured images, Gutenberg, and you” by @jonihalabi.bsky.social https://jhalabi.com/blog/2019/03/wordpress-featured-image-and-gutenberg/" rel="noreferrer noopener">
      <span class="sr-only">Bluesky</span>
    </a>

    <a class="ri-facebook-fill" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://jhalabi.com/blog/2019/03/wordpress-featured-image-and-gutenberg/" rel="noreferrer noopener">
      <span class="sr-only">Facebook</span>
    </a>

    <a class="ri-linkedin-box-fill" target="_blank" href="https://www.linkedin.com/shareArticle?url=https://jhalabi.com/blog/2019/03/wordpress-featured-image-and-gutenberg/" rel="noreferrer noopener">
      <span class="sr-only">LinkedIn</span>
    </a>

    <a class="ri-mastodon-fill" target="_blank" href="https://higheredweb.social/share?text=Check out “Featured images, Gutenberg, and you” by @jonihalabi@higheredweb.social https://jhalabi.com/blog/2019/03/wordpress-featured-image-and-gutenberg/" rel="noreferrer noopener">
      <span class="sr-only">LinkedIn</span>
    </a>
  </div>

</main>

<footer>

    <div class="footer-top">
  
      <div class="footer-top-code">
        <p>const joni = {</p>
        <dl>
          <dt>"description":</dt>
          <dd>"Web developer, author, and conference speaker who writes technical articles, as well as creative works that focus on life as a single mother by choice.",</dd>
          <dt>"press_kit":</dt>
          <dd>"<a href="/press-kit/">Biographies, book information, and photos for public use</a>"</dd>
        </dl>
        <p>};</p>
      </div>
  
      <ul class="footer-top-socials">
        <li>
          <a href="/feed.xml" class="ri-rss-fill">Blog feed</a>
        </li>

        <li>
          <a href="https://bsky.app/profile/jonihalabi.bsky.social" class="ri-bluesky-fill">Bluesky</a>
        </li>
  
        <li>
          <a href="https://www.instagram.com/jonihalabi/" class="ri-instagram-fill">Instagram</a>
        </li>
  
        <li>
          <a href="https://www.linkedin.com/in/jonihalabi/" class="ri-linkedin-fill">LinkedIn</a>
        </li>
      </ul>
  
    </div>
  
  
  
    <div class="footer-copyright">
      <div>
        <p>
          Copyright &copy; 2025 Joni Halabi. All rights reserved.
  
          <span id="day-0">Happy Sunday! Today is French toast day in our house.</span>
          <span id="day-1">Whelp, it's Monday. Go ahead and have that extra cup of tea.</span>
          <span id="day-2">Happy "We survived Monday" day! Otherwise known as Tuesday.</span>
          <span id="day-3">Ah... Wednesday. So close, yet so far.</span>
          <span id="day-4">It's Thursday. Almost there!</span>
          <span id="day-5">Happy Friday. We made it!</span>
          <span id="day-6">It's the weekend. Hooray!</span>
        </p>
      </div>
    </div>
  </footer>
  
  <script>
    const d=new Date(); const n=d.getDay();document.getElementById('day-'+n).classList.add('show');
  </script>
  
</body>
</html>

